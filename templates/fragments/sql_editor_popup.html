<!-- SQL Editor Popup - POLISHED DESIGN -->
<div id="sql-editor-popup"
    class="fixed top-16 right-2 sm:right-4 w-full sm:w-3/4 lg:w-1/2 h-2/3 theme-surface-secondary theme-border border rounded-xl shadow-2xl z-30 transform transition-all duration-300 ease-in-out flex flex-col translate-x-full backdrop-blur-sm">

    <!-- SQL Editor Header with Action Buttons -->
    <div
        class="sql-editor-header flex items-center justify-between p-3 sm:p-4 theme-border border-b theme-surface-primary shrink-0 rounded-t-xl bg-gradient-to-r from-blue-50/50 to-indigo-50/50 dark:from-gray-800/50 dark:to-gray-700/50">
        <!-- Left side - Enhanced Brand -->
        <div class="flex items-center gap-2 sm:gap-3 min-w-0 flex-1">
            <img src="/static/images/Brand Product.png" alt="GeniE-ditor Logo"
                class="h-6 w-6 sm:h-7 sm:w-7 object-contain rounded-sm hover:scale-105 transition-transform duration-200 flex-shrink-0" />
            <span
                class="text-base sm:text-lg font-bold bg-gradient-to-r from-blue-600 to-indigo-600 dark:from-blue-400 dark:to-indigo-400 bg-clip-text text-transparent tracking-wide truncate">
                GeniE‑ditor
            </span>
            <span
                class="text-xs px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded-full font-medium flex-shrink-0">
                SQL
            </span>
        </div>

        <!-- Right side - Enhanced Action buttons -->
        <div class="flex items-center gap-1 flex-shrink-0">
            <!-- Execute Button -->
            <button id="execute-query" title="Execute Query (Ctrl+Enter)"
                class="flex items-center gap-1 sm:gap-2 px-2 sm:px-3 py-2 bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white rounded-lg transition-all duration-200 shadow-sm hover:shadow-md transform hover:scale-105 font-medium text-sm">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M5 3v18l15-9L5 3z" />
                </svg>
                <span class="hidden sm:inline">Run</span>
            </button>

            <!-- Minimize Button -->
            <button id="sql-editor-minimize" title="Minimize Editor"
                class="p-2 rounded-lg hover:bg-yellow-100 dark:hover:bg-yellow-900/30 transition-all duration-200 group">
                <svg xmlns="http://www.w3.org/2000/svg"
                    class="h-4 w-4 sm:h-5 sm:w-5 text-yellow-600 dark:text-yellow-400 group-hover:scale-110 transition-transform"
                    fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4" />
                </svg>
            </button>

            <!-- Close Button -->
            <button id="sql-editor-close" title="Close Editor"
                class="p-2 rounded-lg hover:bg-red-100 dark:hover:bg-red-900/30 transition-all duration-200 group">
                <svg xmlns="http://www.w3.org/2000/svg"
                    class="h-4 w-4 sm:h-5 sm:w-5 text-red-600 dark:text-red-400 group-hover:scale-110 transition-transform"
                    viewBox="0 0 24 24" fill="currentColor">
                    <path fill-rule="evenodd"
                        d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm3.536 14.121a1 1 0 01-1.414 0L12 13.414 9.879 15.536a1 1 0 01-1.414-1.414L10.586 12 8.464 9.879a1 1 0 011.414-1.414L12 10.586l2.121-2.121a1 1 0 011.414 1.414L13.414 12l2.121 2.121a1 1 0 010 1.414z"
                        clip-rule="evenodd" />
                </svg>
            </button>
        </div>
    </div>

    <!-- SQL Editor Content Area -->
    <div class="sql-editor-content flex-1 flex flex-col min-h-0">
        <!-- Enhanced Editor Toolbar -->
        <div
            class="flex items-center justify-between px-3 sm:px-4 py-2 sm:py-3 theme-border border-b theme-surface-primary bg-gradient-to-r from-gray-50/30 to-blue-50/30 dark:from-gray-800/30 dark:to-gray-700/30">
            <div class="flex items-center gap-2 sm:gap-4 text-sm theme-text-secondary min-w-0">
                <div class="flex items-center gap-2">
                    <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse flex-shrink-0"></div>
                    <span class="font-medium">Ready</span>
                </div>
                <div class="hidden md:flex items-center gap-2">
                    <span>Line: 1</span>
                    <span class="text-gray-400">•</span>
                    <span>Col: 1</span>
                </div>
            </div>
            <div class="flex items-center gap-2 sm:gap-3 flex-shrink-0">
                <!-- Database Type Badge -->
                <span
                    class="px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded text-xs font-medium">MySQL</span>

                <!-- Toolbar Actions -->
                <div class="hidden sm:flex items-center gap-1">
                    <button title="Toggle Syntax Highlighting" class="p-1.5 theme-hover rounded-md transition-colors">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 theme-text-secondary" fill="none"
                            viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM7 21h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01" />
                        </svg>
                    </button>
                    <button title="Toggle Word Wrap" class="p-1.5 theme-hover rounded-md transition-colors">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 theme-text-secondary" fill="none"
                            viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M4 6h16M4 12h8m-8 6h16" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- Enhanced Main Editor Area -->
        <div class="flex-1 p-3 sm:p-4 min-h-0">
            <div id="sql-editor-container"
                class="relative h-full overflow-hidden rounded-xl theme-border border-2 theme-surface-secondary shadow-inner bg-gradient-to-br from-white to-gray-50/50 dark:from-gray-900 dark:to-gray-800/50">
                <div id="sql-editor"
                    class="h-full p-3 sm:p-4 theme-text-primary font-mono text-sm overflow-auto leading-relaxed">
                    <!-- CodeMirror will be initialized here -->
                </div>
            </div>
        </div>

        <!-- Enhanced Status Bar -->
        <div
            class="px-3 sm:px-4 py-2 sm:py-3 theme-border border-t theme-surface-primary shrink-0 bg-gradient-to-r from-gray-50/50 to-blue-50/50 dark:from-gray-800/50 dark:to-gray-700/50 rounded-b-xl">
            <div class="flex items-center justify-between text-xs theme-text-secondary">
                <div class="flex items-center gap-2 sm:gap-4 min-w-0">
                    <div class="flex items-center gap-2">
                        <div class="w-1.5 h-1.5 bg-green-500 rounded-full flex-shrink-0"></div>
                        <span class="font-medium">Connected</span>
                    </div>
                    <span class="hidden sm:inline text-gray-400">•</span>
                    <span class="hidden sm:inline truncate">MySQL Database</span>
                </div>
                <div class="flex items-center gap-1 sm:gap-2 font-medium flex-shrink-0">
                    <kbd class="px-1 sm:px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded text-xs">Ctrl</kbd>
                    <span class="hidden sm:inline">+</span>
                    <kbd class="px-1 sm:px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded text-xs">Enter</kbd>
                    <span class="ml-1 hidden sm:inline">to execute</span>
                </div>
            </div>
        </div>
    </div>
</div>